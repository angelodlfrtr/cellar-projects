class Todo < ApplicationRecord

  # ==========================================================================================================
  # Relations ================================================================================================
  # ==========================================================================================================

  belongs_to :user

  # ==========================================================================================================
  # Validations ==============================================================================================
  # ==========================================================================================================

  validates :title,
    presence: true,
    length: { minium: 1, maximum: 64 }

  validates :user, presence: true

  # ==========================================================================================================
  # Callbacks ================================================================================================
  # ==========================================================================================================

  before_save :set_default_deadline

  # ==========================================================================================================
  # Instance methods =========================================================================================
  # ==========================================================================================================

  def done!
    self.update! done: true
  end

  def parsed_content
    GitHub::Markup.render_s(GitHub::Markups::MARKUP_MARKDOWN, self.content)
  end

  private

    def set_default_deadline
      self.deadline = DateTime.now + 1.day unless self.deadline
    end
end

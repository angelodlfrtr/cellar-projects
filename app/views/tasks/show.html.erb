<%= render partial: 'partials/project_menu' %>

<div class="container">
  <div class="columns">
    <div class="column col-9">
      <div class="card">
        <div class="card-header">
          <div class="btn-group float-right">
            <% if @task.closed %>
              <%= link_to "Re-open",
                reopen_task_path(@project.slug, @task.id),
                method: :post, class: 'btn btn-primary' %>
            <% else %>
              <%= link_to "Close",
                close_task_path(@project.slug, @task.id),
                method: :post, class: 'btn btn-primary' %>
            <% end %>

            <%= link_to "Edit.",
              edit_task_path(@project.slug, @task.id), class: 'btn btn-default' %>

            <%= link_to "Destroy",
              delete_task_path(@project.slug, @task.id),
              method: :delete,
              data: { confirm: "Do you really want to destroy this task ?" },
              class: 'btn btn-default' %>
          </div>

          <h2 class="card-title text-bold">
            <% if @task.closed %>
              [CLOSED]
            <% end %>
            <%= @task.name %>
          </h2>
          <h2 class="card-subtitle">
            Opened at <%= l @task.created_at, format: :long %>
            by <%= @task.user.email %>
          </h2>
        </div>

        <div class="divider"></div>

        <div class="card-body">
          <%= @task.description %>
        </div>
      </div>

      <%= render partial: 'comments' %>
    </div>

    <div class="column col-3">
      <div class="card">
        <div class="card-body">
          <div class="tile">
            <div class="tile-content">
              <p class="tile-title text-bold">Assigned to</p>
              <p class="tile-title"><%= @task.assigned.email %></p>
            </div>
          </div>

          <div class="divider"></div>

          <div class="tile">
            <div class="tile-content">
              <p class="tile-title text-bold">Start</p>
              <p class="tile-title"><%= l @task.start_date, format: :long %></p>
            </div>
          </div>

          <div class="divider"></div>

          <div class="tile">
            <div class="tile-content">
              <p class="tile-title text-bold">Deadline</p>
              <p class="tile-title"><%= l @task.end_date, format: :long %></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
